function EntityControl(n,t,i){var t='[name^="'+t,r='"]',f="",o={},u="",e,s;switch(i){case ActionTypes.Create:u="Create";break;case ActionTypes.Update:u="Edit";break;case ActionTypes.Delete:u="Delete"}i==ActionTypes.Create&&$(t+".EntityID"+r).val($("#BaseID").val());switch(n){case EntityTypes.PhoneNumber:o={ID:$(t+".ID"+r).val(),EntityID:$(t+".EntityID"+r).val(),Type:$(t+".Type"+r).val(),Number:$(t+".Number"+r).val()};u="/PhoneNumber/"+u;f=t+r;break;case EntityTypes.EmailAddress:o={ID:$(t+".ID"+r).val(),EntityID:$(t+".EntityID"+r).val(),Type:$(t+".Type"+r).val(),Address:$(t+".Address"+r).val()};u="/EmailAddress/"+u;f=t+r;break;case EntityTypes.StreetAddress:o={ID:$(t+".ID"+r).val(),EntityID:$(t+".EntityID"+r).val(),Street:$(t+".Street"+r).val(),Street2:$(t+".Street2"+r).val(),City:$(t+".City"+r).val(),StateID:$(t+".StateID"+r).val(),ZIP:$(t+".ZIP"+r).val()};u="/StreetAddress/"+u;f=t+r;break;case EntityTypes.Person:e="Entity_Base.";o={ID:$(t+"ID"+r).val(),BaseID:$(t+"BaseID"+r).val(),FirstName:$(t+"FirstName"+r).val(),LastName:$(t+"LastName"+r).val(),LicenseNumber:$(t+"LicenseNumber"+r).val(),Entity_Base:{ID:$(t+e+"ID"+r).val(),IsActive:$(t+e+"IsActive"+r).val(),IsMailable:$(t+e+"IsMailable"+r).val(),IsEmailable:$(t+e+"IsEmailable"+r).val(),Comments:$(t+e+"Comments"+r).val()}};f=".personDetail label";u="/Person/"+u}s=JSON.stringify(o);$.ajax({type:"POST",url:u,dataType:"json",contentType:"application/json; charset=utf-8",data:s,success:function(n){console.log(n);n.ChangeCount>0&&(i==ActionTypes.Delete?$(f).fadeOutAndRemove():$(f).highlightSave(),i==ActionTypes.Create&&$(t+".ID"+r).val(n.NewID))},error:function(n){console.log("There was an error posting the data to the server: "+n.responseText)}})}function EntityCRUD(n,t,i){switch(t.toLowerCase()){case"phone":t=EntityTypes.PhoneNumber;break;case"email":t=EntityTypes.EmailAddress;break;case"address":t=EntityTypes.StreetAddress;break;case"person":t=EntityTypes.Person}switch(i.toLowerCase()){case"create":i=ActionTypes.Create;break;case"delete":i=ActionTypes.Delete;break;case"update":i=ActionTypes.Update}if(i==ActionTypes.Delete){var r='[name="'+n+'.EntityID"]',u='[name^="'+n+'"]';if($(r).val()==""){$(u).fadeOutAndRemove();return}}EntityControl(t,n,i)}function AddPhone(n){EntityControl(EntityTypes.PhoneNumber,n,ActionTypes.Create)}function UpdatePhone(n){EntityControl(EntityTypes.PhoneNumber,n,ActionTypes.Update)}function DeletePhone(n){var t='[name="'+n+'.EntityID"]',i='[name^="'+n+'"]';$(t).val()==""?$(i).fadeOutAndRemove():EntityControl(EntityTypes.PhoneNumber,n,ActionTypes.Delete)}function AddEmail(n){EntityControl(EntityTypes.EmailAddress,n,ActionTypes.Create)}function UpdateEmail(n){EntityControl(EntityTypes.EmailAddress,n,ActionTypes.Update)}function DeleteEmail(n){var t='[name="'+n+'.EntityID"]',i='[name^="'+n+'"]';$(t).val()==""?$(i).fadeOutAndRemove():EntityControl(EntityTypes.EmailAddress,n,ActionTypes.Delete)}var viewModel={addNewPhone:function(){var n=$("#phoneNumberTemplate").render({index:viewModel._generateGuid()});$("#PhoneNumberEditor").append(n);$(".phoneNumber").mask("(999) 999-9999")},addNewEmail:function(){var n=$("#emailAddressTemplate").render({index:viewModel._generateGuid()});$("#EmailAddresssEditor").append(n)},_generateGuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)})}},EntityTypes={PhoneNumber:0,EmailAddress:1,StreetAddress:2,Person:3},ActionTypes={Create:0,Update:1,Delete:2};jQuery.fn.fadeOutAndRemove=function(){$(this).effect("highlight",{color:"red"},1e3,function(){$(this).parent().fadeOut("fast")})};jQuery.fn.highlightSave=function(){$(this).effect("highlight",{color:"green"},2e3)};$(document).ready(function(){$("#UploadPersonFiles").fineUploader({request:{endpoint:"/Files/UploadFile",paramsInBody:!0,validation:{sizeLimit:5e4},text:{uploadButton:"Click or drop new fule"},request:{paramsInBody:!0},params:{EntityID:$("#ID").val(),EntityType:1}}})});
/*
//# sourceMappingURL=PersonViewModel.min.js.map
*/