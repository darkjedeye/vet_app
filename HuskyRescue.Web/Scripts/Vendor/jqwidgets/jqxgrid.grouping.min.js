(function(n){n.jqx.dataview.grouping=function(){this.loadgrouprecords=function(t,i,r,u,f,e,o,s,h){for(var k=t,y=this,et=[],g,v,at,st,d,rt,p,c,nt,vt,ht,ut,it,yt,ft,l,b,w=0;w<y.groups.length;w++)et[w]=y.generatekey();var ct=[],bt=0,et=et,ot=[],l=i,kt=i,lt=y.groups.length;if(this.loadedrecords=[],this.bounditems=[],this.loadedrecords=[],this.loadedrootgroups=[],this.loadedgroups=[],this.loadedgroupsByKey=[],this.sortedgroups=[],g=this.sortdata!=null,v=g?this.sortdata:this.records,this.pageable&&(at=Object.prototype.toString,st=this.groups[0],Object.prototype.toString=typeof st=="function"?st:function(){return this[st]},v.sort||(d=[],rt=0,n.each(v,function(){d[i+rt++]=this}),v=d),g?v.sort(function(t,i){var t=t.value,i=i.value,u;if(t===undefined&&(t=null),i===undefined&&(i=null),t===null&&i===null)return 0;if(t===null&&i!==null)return 1;if(t!==null&&i===null)return-1;if(n.jqx.dataFormat.isNumber(t)&&n.jqx.dataFormat.isNumber(i)||n.jqx.dataFormat.isDate(t)&&n.jqx.dataFormat.isDate(i))return t<i?-1:t>i?1:0;n.jqx.dataFormat.isNumber(t)||n.jqx.dataFormat.isNumber(i)||(t=String(t).toLowerCase(),i=String(i).toLowerCase());try{if(t<i)return-1;if(t>i)return 1}catch(r){u=r}return 0}):v.sort(function(t,i){if(t===undefined&&(t=null),i===undefined&&(i=null),t===null&&i===null)return 0;if(t===null&&i!==null)return 1;if(t!==null&&i===null)return-1;if((t=t.toString(),i=i.toString(),n.jqx.dataFormat.isNumber(t)&&n.jqx.dataFormat.isNumber(i))||n.jqx.dataFormat.isDate(t)&&n.jqx.dataFormat.isDate(i))return t<i?-1:t>i?1:0;n.jqx.dataFormat.isNumber(t)||n.jqx.dataFormat.isNumber(i)||(t=String(t).toLowerCase(),i=String(i).toLowerCase());try{if(t<i)return-1;if(t>i)return 1}catch(r){var u=r}return 0}),Object.prototype.toString=at),this.virtualmode){for(d=[],rt=0,l=0;l<r-i;l++)d[i+rt++]=v[l];v=d}for(p=i;p<r;p++){for(c={},c=g?n.extend({},v[p].value):n.extend({},v[p]),id=c[y.uniqueId],(f>=s||id!=o[f][y.uniqueId]||e&&e[id])&&(h[h.length]=f),nt=[],vt=0,w=0;w<lt;w++)b=y.groups[w],ht=c[b],ht==null&&(ht=""),nt[vt++]={value:ht,hash:et[w]};if(nt.length!=lt)break;var a=null,tt="",dt=-1;for(ut=0;ut<nt.length;ut++){if(dt++,it=nt[ut].value,yt=nt[ut].hash,tt=tt+"_"+yt+"_"+it,ot[tt]!=undefined&&ot[tt]!=null){a=ot[tt];continue}a==null?(a={group:it,subItems:[],subGroups:[],level:0},ct[bt++]=a,a.uniqueid=y.generatekey(),y.loadedgroupsByKey[it]=a):(ft={group:it,subItems:[],subGroups:[],parentItem:a,level:a.level+1},y.loadedgroupsByKey[a.uniqueid+"_"+it]=ft,ft.uniqueid=y.generatekey(),a.subGroups[a.subGroups.length++]=ft,a=ft),ot[tt]=a}a!=null?(c.uid||(c.uid=this.getid(this.source.id,c,l)),g?(c.boundindex=v[p].index,this.recordsbyid["id"+c.uid]=v[p].value):(c.boundindex=l,this.recordsbyid["id"+c.uid]=v[p]),this.bounditems[c.boundindex]=c,this.sortedgroups[l]=c,c.uniqueid=y.generatekey(),c.parentItem=a,c.level=a.level+1,a.subItems[a.subItems.length++]=c):(c.uid||(c.uid=this.getid(this.source.id,c,l)),g?(c.boundindex=v[p].index,this.recordsbyid["id"+c.uid]=v[p].value):(c.boundindex=l,this.recordsbyid["id"+c.uid]=v[p]),this.sortedgroups[l]=c,this.bounditems[c.boundindex]=c,c.uniqueid=y.generatekey()),f++,l++,kt++}var pt=function(n,i,r){for(var u=0;u<i.subItems.length;u++)i.subItems[u].visibleindex=t+r,n.rows[r]=i.subItems[u],n.loadedrecords[r]=i.subItems[u],r++;return r},wt=function(n,i,r){var f=function(i){if(n.aggregates==!0){var f=i,u={};f!=null&&(u.level=f.level,u.visibleindex=t+r,u.uniqueid=n.generatekey(),n.rows[r]=u,n.loadedrecords[r++]=u,u.totalsrow=!0,i.subItems.length>0?(f=i.subItems[i.subItems.length-1],u.parentItem=f.parentItem,u.parentItem.subItems&&(u.parentItem.subItems[u.parentItem.subItems.length]=u)):i.subGroups.length>0&&(f=i.subGroups[i.subGroups.length-1],u.level=f.level,u.parentItem=i,i.subGroups[i.subGroups.length]=u))}},u;for(subGroup in i.subGroups)u=i.subGroups[subGroup],u.subGroups&&(n.loadedgroups[n.loadedgroups.length]=u,u.visibleindex=t+r,n.rows[r]=u,n.loadedrecords[r]=u,r++,u.subGroups.length>0?r=wt(n,u,r):u.subItems.length>0&&(r=pt(n,u,r)),f(u));return i.subItems.length>0&&(r=pt(n,i,r)),f(i),r},gt=ct.length;for(this.loadedgroups=[],this.rows=[],k=0,l=0;l<gt;l++)b=ct[l],this.loadedrootgroups[l]=b,this.loadedgroups[this.loadedgroups.length]=b,b.visibleindex=t+k,this.rows[k]=b,this.loadedrecords[k]=b,k++,k=wt(this,b,k);return k},this._updategroupsinpage=function(t,i,r,u,f,e,o){var b=[],ft=[],tt,v,y,ot,h,it,k,w,st,d,c,a,l;if(this.groupable&&this.groups.length>0){var g=0,nt=[],et=[];for(h=0;h<t.groups.length;h++)et[h]=t.generatekey();var a=0,rt=[],lt=0;for(o>this.totalrecords&&(o=this.totalrecords),tt=e;tt<o;tt++){if(v=n.extend({},t.sortedgroups[tt]),id=v[t.uniqueId],!t.pagesize||r>=t.pagesize*t.pagenum&&r<t.pagesize*(t.pagenum+1)){for((u>=f||id!=b[u][t.uniqueId]||updated&&updated[id])&&(ft[ft.length]=u),y=[],ot=0,h=0;h<t.groups.length;h++)l=t.groups[h],it=v[l],null==it&&(it=""),y[ot++]={value:it,hash:et[h]};if(y.length!=t.groups.length)break;var s=null,p="",at=-1;for(k=0;k<y.length;k++){if(at++,w=y[k].value,st=y[k].hash,p=p+"_"+st+"_"+w,nt[p]!=undefined&&nt[p]!=null){s=nt[p];continue}s==null?(s={group:w,subItems:[],subGroups:[],level:0},rt[lt++]=s,c=t.loadedgroupsByKey[w],c!=undefined&&(s.visibleindex=c.visibleindex,s.uniqueid=c.uniqueid)):(d={group:w,subItems:[],subGroups:[],parentItem:s,level:s.level+1},c=t.loadedgroupsByKey[s.uniqueid+"_"+w],d.visibleindex=c.visibleindex,d.uniqueid=c.uniqueid,s.subGroups[s.subGroups.length++]=d,s=d),nt[p]=s}s!=null&&(v.parentItem=s,v.level=s.level+1,s.subItems[s.subItems.length++]=v),u++}a++,r++}var ht=function(t,i,r){for(var u=0;u<i.subItems.length;u++)b[r]=n.extend({},i.subItems[u]),r++;return r},ut=function(n){var i=!1,t,r;for(subGroup in n.subGroups)if(t=n.subGroups[subGroup],t.subGroups&&(t.subGroups.length>0&&(r=ut(t),r)||t.subItems.length>0))return i=!0,!0;return n.subItems.length>0?(i=!0,!0):i},ct=function(n,t,i){for(subGroup in t.subGroups){var r=t.subGroups[subGroup];r.subGroups&&ut(r)&&(b[i]=r,i++,r.subGroups.length>0?i=ct(n,r,i):r.subItems.length>0&&(i=ht(n,r,i)))}return t.subItems.length>0&&(i=ht(n,t,i)),i};for(a=0;a<rt.length;a++)l=rt[a],ut(l)&&(b[g]=l,g++,g=ct(this,l,g))}return b}},n.extend(n.jqx._jqxGrid.prototype,{_initgroupsheader:function(){var t,f,r,i,u;this.groupsheader.css("visibility","hidden"),this._groupsheader()&&(this.groupsheader.css("visibility","inherit"),t=this,f=this.gridlocalization.groupsheaderstring,this.groupsheaderdiv=this.groupsheaderdiv||n('<div style="width: 100%; position: relative;"><\/div>'),this.groupsheaderdiv.height(this.groupsheaderheight),this.groupsheaderdiv.css("top",0),this.groupsheader.append(this.groupsheaderdiv),this.groupheadersbounds=[],r=this.groups.length,this.groupsheaderdiv.children().remove(),this.groupsheaderdiv[0].innerHTML="",i=[],r>0?n.each(this.groups,function(u){var s=this,c=t._getColumnText(this),l=c.label,f=t._rendergroupcolumn(l,s),o,h,e;f.addClass(t.toThemeProperty("jqx-grid-group-column")),t.groupsheaderdiv.append(f),t.closeablegroups&&(o=n(f.find(".jqx-icon-close")),t.isTouchDevice()&&t.touchmode!==!0?t.addHandler(o,"touchstart",function(){return t.removegroupat(u),!1}):t.addHandler(o,"click",function(){return t.removegroupat(u),!1})),t.sortable&&t.addHandler(f,"click",function(){var n=t.getcolumn(s);return n!=null&&t._togglesort(n),!1}),i[i.length]=f,t._handlegroupstocolumnsdragdrop(this,f),u<r-1&&(h=f.height(),e=n('<div style="float: left; position: relative;"><\/div>'),t.rtl&&e.css("float","right"),e.width(t.groupindentwidth/3),e.height(1),e.css("top",h/2),e.addClass(t.toThemeProperty("jqx-grid-group-column-line")),t.groupsheaderdiv.append(e))}):(u=n('<div style="position: relative;">'+f+"<\/div>"),this.groupsheaderdiv.append(u),this.rtl&&u.addClass(this.toThemeProperty("jqx-rtl"))),this._groupheaders=i,this._updategroupheadersbounds())},_updategroupheadersbounds:function(){var i=this,r=this.groupsheaderdiv.children().outerHeight(),t=(this.groupsheader.height()-r)/2;this.groupsheaderdiv.css("top",t),this.rtl?this.groupsheaderdiv.css("right",t):this.groupsheaderdiv.css("left",t),this.rtl&&this._groupheaders.reverse(),n.each(this._groupheaders,function(n){var t=this.coord();i.groupheadersbounds[n]={left:t.left,top:t.top,width:this.outerWidth(),height:this.outerHeight(),index:n}})},addgroup:function(n){if(n){var t=this;t.groups!==t.dataview.groups&&(t.dataview.groups=t.groups),t.groups[t.groups.length]=n,t.refreshgroups(),this._raiseEvent(12,{type:"Add",index:t.groups[t.groups.length],groups:t.groups})}},insertgroup:function(n,t){if(n!=undefined&&n!=null&&n>=0&&n<=this.groups.length&&t){var i=this;i.groups!==i.dataview.groups&&(i.dataview.groups=i.groups),i.groups.splice(n,0,t),i.refreshgroups(),this._raiseEvent(12,{type:"Insert",index:n,groups:i.groups})}},refreshgroups:function(){this._refreshdataview(),this._render(!0,!0,!0,!1)},_insertaftergroup:function(n,t){var i=this._getGroupIndexByDataField(n);this.insertgroup(i+1,t)},_insertbeforegroup:function(n,t){var i=this._getGroupIndexByDataField(n);this.insertgroup(i,t)},removegroupat:function(n){if(n>=0&&n!=null&&n!=undefined){var t=this;return t.groups!==t.dataview.groups&&(t.dataview.groups=t.groups),t.groups.splice(n,1),t.refreshgroups(),t.virtualmode&&t.updatebounddata(),this._raiseEvent(12,{type:"Remove",index:n,groups:t.groups}),!0}return!1},cleargroups:function(){var n=this;return n.groups=[],n.dataview.groups=n.groups,n.refreshgroups(),this._raiseEvent(12,{type:"Clear",groups:n.groups}),!0},removegroup:function(n){if(n==null)return!1;var t=this.groups.indexOf(n.toString());return this.removegroupat(t)},getrootgroupscount:function(){return this.dataview.loadedrootgroups.length},collapsegroup:function(n){return this._setrootgroupstate(n,!1)},expandgroup:function(n){return this._setrootgroupstate(n,!0)},collapseallgroups:function(n){this._setbatchgroupstate(!1,n)},expandallgroups:function(n){this._setbatchgroupstate(!0,n)},getgroup:function(t){var i=this.dataview.loadedrootgroups[t],e,u,r;if(i==null)return null;var o=this.expandedgroups[i.uniqueid].expanded,s=i.group,h=i.level,f=[];return this._getsubgroups(f,i),e=this,u={group:s,level:h,expanded:o,subgroups:f},i.subItems&&(r=[],n.each(i.subItems,function(){var n=this.boundindex;r[r.length]=e.getrowdata(n)}),r.length>0&&(u.subrows=r)),u},getrootgroups:function(){for(var i=this.dataview.loadedrootgroups.length,t=[],n=0;n<i;n++)t[n]=this.getgroup(n);return t},_getsubgroups:function(t,i){var f=this,u,e;for(obj in i.subGroups){var r=i.subGroups[obj],o=f.expandedgroups[r.uniqueid].expanded,s=r.group,h=r.level;t[t.length]={group:s,level:h,expanded:o},r.subItems&&(u=[],n.each(r.subItems,function(){var n=this.boundindex;u[u.length]=f.getrowdata(n)}),t[t.length-1].subrows=u),r.subGroups&&(e=[],f._getsubgroups(e,r))}return t},_setbatchgroupstate:function(n,t){var i=this,r;for(obj in this.dataview.loadedrootgroups)i._setrootgroupstate(obj,n,!1,!0);return t==!1?(i._requiresupdate=!0,i._renderrows(i.virtualsizeinfo),!0):(r=this.vScrollBar[0].style.visibility,this.rendergridcontent(!0,!1),(r!=this.vScrollBar[0].style.visibility||this._hiddencolumns)&&(this._updatecolumnwidths(),this._updatecellwidths(),this._renderrows(this.virtualsizeinfo)),!0)},_setrootgroupstate:function(n,t,i,r){var o,f,e,u;if(n==undefined||n==null||n<0||!this.groupable||this.groups.length==0)return!1;if(o=i!=undefined?i:!0,n>=0&&n<this.dataview.loadedrootgroups.length){if(f=this.dataview.loadedrootgroups[n],this.pageable){for(e=[],u=0;u<this.dataview.rows.length;u++)this.dataview.rows[u].group!=null&&this.dataview.rows[u].level===0&&e.push(this.dataview.rows[u]);if(f=e[n],!f)return}return this._setgroupstate(f,t,o,r)}return!1},_togglegroupstate:function(n,t){var r,i,u;return n==null||n==undefined?!1:(r=this.vScrollInstance.value,i=this.expandedgroups[n.uniqueid],i=i==undefined?!1:i.expanded,i=!i,u=this._setgroupstate(n,i,t),r!==0&&this.vScrollBar.css("visibility")!=="hidden"&&(r<=this.vScrollInstance.max?this.vScrollInstance.setPosition(r):this.vScrollInstance.setPosition(this.vScrollInstance.max)),u)},_setgroupstate:function(n,t,i,r){var u,f,e;return n==null||n==undefined?!1:(u=!1,this.editable&&this.editcell&&this.endcelledit(this.editcell.row,this.editcell.column,!1,!1),f=this.expandedgroups[n.uniqueid],f==undefined&&(f={expanded:!1},u=!0),f.expanded!=t&&(u=!0),u)?(this.expandedgroups[n.uniqueid]={expanded:t,group:n},this._setsubgroupsvisibility(this,n,!t,r),i&&(e=this.vScrollBar[0].style.visibility,this.rendergridcontent(!0,!1),(e!=this.vScrollBar[0].style.visibility||this._hiddencolumns)&&(this._updatecolumnwidths(),this._updatecellwidths(),this._renderrows(this.virtualsizeinfo))),(undefined==this.suspendgroupevents||this.suspendgroupevents==!1)&&(t?this._raiseEvent(4,{group:n.group,parentgroup:n.parentItem?n.parentItem.group:null,level:n.level,visibleindex:n.visibleindex}):this._raiseEvent(5,{group:n.group,parentgroup:n.parentItem?n.parentItem.group:null,level:n.level,visibleindex:n.visibleindex})),!0):!1},_setgroupitemsvisibility:function(n,t,i){for(var r=0;r<t.subItems.length;r++)n._setrowvisibility(t.subItems[r].visibleindex,i,!1)},_setsubgroupsvisibility:function(n,t,i,r){var u,f;if(t.parentItem!=null){if(this.hiddens[t.parentItem.visibleindex])return}else if(t.parentItem==null&&this.hiddens[t.visibleindex])return;for(subGroup in t.subGroups)u=t.subGroups[subGroup],i||n._setrowvisibility(u.visibleindex,i,!1),f=!i,r?this.expandedgroups[u.uniqueid]={expanded:f,group:u}:f=n.expandedgroups[u.uniqueid]==undefined?!1:n.expandedgroups[u.uniqueid].expanded,u.subGroups&&(u.subGroups.length>0?n._setsubgroupsvisibility(n,u,!f||i,r):u.subItems.length>0&&n._setgroupitemsvisibility(n,u,!f||i)),i&&n._setrowvisibility(u.visibleindex,i,!1);t.subItems&&t.subItems.length>0&&n._setgroupitemsvisibility(n,t,i)},_handlecolumnsdragdrop:function(){var t=this,i=-1,r=!1;if(t.groupable){var f="mousemove.grouping"+this.element.id,o="mousedown.grouping"+this.element.id,e="mouseup.grouping"+this.element.id,u=!1;this.isTouchDevice()&&this.touchmode!==!0&&(u=!0,f=n.jqx.mobile.getTouchEventName("touchmove")+".grouping"+this.element.id,o=n.jqx.mobile.getTouchEventName("touchstart")+".grouping"+this.element.id,e=n.jqx.mobile.getTouchEventName("touchend")+".grouping"+this.element.id),this.removeHandler(n(document),f),this.addHandler(n(document),f,function(f){var o,e,c,h,y,p,s,k;if(!t.showgroupsheader)return!0;if(t.dragcolumn!=null){o=parseInt(f.pageX),e=parseInt(f.pageY),u&&(c=t.getTouches(f),h=c[0],o=parseInt(h.pageX),e=parseInt(h.pageY));var l=t.host.coord(),a=parseInt(l.left),v=parseInt(l.top);if((t.dragmousedownoffset==undefined||t.dragmousedownoffset==null)&&(t.dragmousedownoffset={left:0,top:0}),y=parseInt(o)-parseInt(t.dragmousedownoffset.left),p=parseInt(e)-parseInt(t.dragmousedownoffset.top),t.dragcolumn.css({left:y+"px",top:p+"px"}),r=!1,o>=a&&o<=a+t.host.width()&&e>=v&&e<=v+t.host.height()&&(r=!0),i=-1,r){t.dragcolumnicon.removeClass(t.toThemeProperty("jqx-grid-dragcancel-icon")),t.dragcolumnicon.addClass(t.toThemeProperty("jqx-grid-drag-icon"));var w=t.groupsheader.coord(),d=w.top+t.groupsheader.height(),b=n.data(t.dragcolumn[0],"datarecord");s=b?t.groups.indexOf(b.toString()):-1,k=s==-1||t.groups.length>1&&s>-1,t.dropline!=null&&(e>=w.top&&e<=d?k&&(i=t._handlegroupdroplines(o)):t.dropline.fadeOut("slow"))}else t.dropline!=null&&t.dropline.fadeOut("slow"),t.dragcolumnicon.removeClass(t.toThemeProperty("jqx-grid-drag-icon")),t.dragcolumnicon.addClass(t.toThemeProperty("jqx-grid-dragcancel-icon"));if(u)return f.preventDefault(),f.stopPropagation(),!1}}),this.removeHandler(n(document),e),this.addHandler(n(document),e,function(f){var a,s,v,l,e,o;if(!t.showgroupsheader)return!0;t.__drag=!1,n(document.body).removeClass("jqx-disableselect"),a=parseInt(f.pageX),s=parseInt(f.pageY),u&&(v=t.getTouches(f),l=v[0],a=parseInt(l.pageX),s=parseInt(l.pageY));var y=t.host.coord(),b=parseInt(y.left),h=parseInt(y.top),p=t.groupsheader.height();if(t.showtoolbar&&(h+=t.toolbarheight),t.dragstarted=!1,t.dragmousedown=null,t.dragcolumn!=null&&(e=n.data(t.dragcolumn[0],"datarecord"),t.dragcolumn.remove(),t.dragcolumn=null,e!=null)){if(!t.getcolumn(e).groupable){t.dropline!=null&&(t.dropline.remove(),t.dropline=null);return}if(r)if(i!=-1){var w=i.index,c=t.groups[w],o=t._getGroupIndexByDataField(e);o!=w&&(o!=undefined&&o>=0&&t.groups.splice(o,1),i.position=="before"?t.rtl?t._insertaftergroup(c,e):t._insertbeforegroup(c,e):t.rtl?t._insertbeforegroup(c,e):t._insertaftergroup(c,e))}else t.groups.length==0?s>h&&s<=h+p&&t.addgroup(e):s>h+p&&(o=t._getGroupIndexByDataField(e),t.removegroupat(o));t.dropline!=null&&(t.dropline.remove(),t.dropline=null)}})}},_getGroupIndexByDataField:function(n){for(var t=0;t<this.groups.length;t++)if(this.groups[t]==n)return t;return-1},_isColumnInGroups:function(n){for(var t=0;t<this.groups.length;t++)if(this.groups[t]==n)return!0;return!1},_handlegroupdroplines:function(t){var i=this,r=-1;return n.each(i.groupheadersbounds,function(n){if(t<=this.left+this.width/2){var u=this.left-3;return n>0&&(u=this.left-1-i.groupindentwidth/6),i.dropline.css("left",u),i.dropline.css("top",this.top),i.dropline.height(this.height),i.dropline.fadeIn("slow"),r={index:n,position:"before"},i.rtl&&(r={index:i.groupheadersbounds.length-1-n,position:"before"}),!1}t>=this.left+this.width/2&&(i.dropline.css("left",1+this.left+this.width),i.dropline.css("top",this.top),i.dropline.height(this.height),i.dropline.fadeIn("slow"),r={index:n,position:"after"},i.rtl&&(r={index:i.groupheadersbounds.length-1-n,position:"after"}))}),r},_handlegroupstocolumnsdragdrop:function(t,i){this.dragmousedown=null,this.dragmousedownoffset=null,this.dragstarted=!1,this.dragcolumn=null;var r=this,u,e="mousedown",o="mousemove",f=!1;this.isTouchDevice()&&this.touchmode!==!0&&(f=!0,e=n.jqx.mobile.getTouchEventName("touchstart"),o=n.jqx.mobile.getTouchEventName("touchmove")),this.addHandler(i,"dragstart",function(){return!1}),this.addHandler(i,e,function(t){var i,u,s,e,o;if(!r.showgroupsheader)return!0;i=t.pageX,u=t.pageY,r.__drag=!0,r.dragmousedown={left:i,top:u},f&&(s=r.getTouches(t),e=s[0],i=e.pageX,u=e.pageY,r.dragmousedown={left:i,top:u},t.preventDefault&&t.preventDefault()),o=n(t.target).coord(),r.dragmousedownoffset={left:parseInt(i)-parseInt(o.left),top:parseInt(u-o.top)}}),this.addHandler(i,o,function(e){var s,o,h,c;if(!r.showgroupsheader)return!0;r.dragmousedown&&(u={left:e.pageX,top:e.pageY},f&&(s=r.getTouches(e),o=s[0],u={left:o.pageX,top:o.pageY}),r.dragstarted||r.dragcolumn!=null||(h=Math.abs(u.left-r.dragmousedown.left),c=Math.abs(u.top-r.dragmousedown.top),(h>3||c>3)&&(r._createdragcolumn(i,u,!0),n(document.body).addClass("jqx-disableselect"),n.data(r.dragcolumn[0],"datarecord",t),e.preventDefault&&e.preventDefault())))})},_createdragcolumn:function(t,i,r){var u=this,s=i,f,e,o,h;u.dragcolumn=n("<div><\/div>"),f=t.clone(),u.dragcolumn.css("z-index",999999),f.css("border-width","1px"),f.css("opacity","0.4"),e=n(f.find("."+u.toThemeProperty("jqx-grid-column-menubutton"))),e.length>0&&e.css("display","none"),o=n(f.find(".jqx-icon-close")),o.length>0&&o.css("display","none"),u.dragcolumnicon=n('<div style="z-index: 9999; position: absolute; left: 100%; top: 50%; margin-left: -18px; margin-top: -7px;"><\/div>'),u.dragcolumnicon.addClass(u.toThemeProperty("jqx-grid-drag-icon")),u.dragcolumn.css("float","left"),u.dragcolumn.css("position","absolute"),h=u.host.coord(),f.width(t.width()+16),u.dragcolumn.append(f),u.dragcolumn.height(t.height()),u.dragcolumn.width(f.width()),u.dragcolumn.append(u.dragcolumnicon),n(document.body).append(u.dragcolumn),f.css("margin-left",0),f.css("left",0),f.css("top",0),u.dragcolumn.css("left",s.left+u.dragmousedown.left),u.dragcolumn.css("top",s.top+u.dragmousedown.top),r!=undefined&&r&&(u.dropline=n('<div style="display: none; position: absolute;"><\/div>'),u.dropline.width(2),u.dropline.addClass(u.toThemeProperty("jqx-grid-group-drag-line")),n(document.body).append(u.dropline))},iscolumngroupable:function(n){return this._getcolumnproperty(n,"groupable")},_handlecolumnstogroupsdragdrop:function(t,i){var r,f,e,u;this.dragmousedown=null,this.dragmousedownoffset=null,this.dragstarted=!1,this.dragcolumn=null,r=this,f=!1,this.isTouchDevice()&&this.touchmode!==!0&&(f=!0),e="mousedown.drag",u="mousemove.drag",f?(e=n.jqx.mobile.getTouchEventName("touchstart")+".drag",u=n.jqx.mobile.getTouchEventName("touchmove")+".drag"):this.addHandler(i,"dragstart",function(){return!1}),this.addHandler(i,e,function(u){var e,o,c,s,h;if(!r.showgroupsheader)return!0;if(r.__drag=!0,r._isColumnInGroups(t.displayfield))return i.css("cursor")!="col-resize"?!0:!0;if(!1==t.groupable)return!0;e=u.pageX,o=u.pageY,f&&(c=r.getTouches(u),s=c[0],e=s.pageX,o=s.pageY),r.dragmousedown={left:e,top:o},f&&u.preventDefault&&u.preventDefault(),h=n(u.target).coord(),r.dragmousedownoffset={left:parseInt(e)-parseInt(h.left),top:parseInt(o-h.top)}}),this.addHandler(i,u,function(e){var o,s,c,h,l,a;if(!r.showgroupsheader)return!0;if(r._isColumnInGroups(t.displayfield))return i.css("cursor")!="col-resize"?!0:!0;r.dragmousedown&&(o=e.pageX,s=e.pageY,f&&(c=r.getTouches(e),h=c[0],o=h.pageX,s=h.pageY),u={left:o,top:s},r.dragstarted||r.dragcolumn!=null||(l=Math.abs(u.left-r.dragmousedown.left),a=Math.abs(u.top-r.dragmousedown.top),(l>3||a>3)&&(r._createdragcolumn(i,u,!0),n.data(r.dragcolumn[0],"datarecord",t.displayfield),e.preventDefault&&e.preventDefault())))})},_rendergroupcolumn:function(t,i){var r=n('<div style="float: left; position: relative;"><\/div>'),o,e,u,f;return this.rtl&&r.css("float","right"),this.groupcolumnrenderer!=null&&(r[0].innerHTML=this.groupcolumnrenderer(t),r.addClass(this.toThemeProperty("jqx-grid-group-column")),r.addClass(this.toThemeProperty("jqx-fill-state-normal"))),this.closeablegroups?(r[0].innerHTML==""&&(r[0].innerHTML='<a style="float: left;" href="#">'+t+"<\/a>"),this.rtl&&(r[0].innerHTML='<a style="float: right;" href="#">'+t+"<\/a>"),o=this.rtl?"left":"right",e='<div style="float: '+o+'; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 100%; top: 50%; margin-left: -18px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-icon-close")+'"><\/div><\/div>',n.jqx.browser.msie&&n.jqx.browser.version<8&&(e='<div style="float: left; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 100%; top: 50%; margin-left: -18px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-icon-close")+'"><\/div><\/div>'),this.rtl&&(e='<div style="float: '+o+'; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 0px; top: 50%; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-icon-close")+'"><\/div><\/div>',n.jqx.browser.msie&&n.jqx.browser.version<8&&(e='<div style="float: left; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 0px; top: 50%; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-icon-close")+'"><\/div><\/div>')),r[0].innerHTML+=e):r[0].innerHTML==""&&(r[0].innerHTML='<a href="#">'+t+"<\/a>"),this.sortable&&(u=n('<div style="float: right; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 100%; top: 50%; margin-left: -16px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-grid-column-sortascbutton")+'"><\/div><\/div>'),f=n('<div style="float: right; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 100%; top: 50%; margin-left: -16px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-grid-column-sortdescbutton")+'"><\/div><\/div>'),this.closeablegroups&&(u=n('<div style="float: right; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 100%; top: 50%; margin-left: -32px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-grid-column-sortascbutton")+'"><\/div><\/div>'),f=n('<div style="float: right; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 100%; top: 50%; margin-left: -32px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-grid-column-sortdescbutton")+'"><\/div><\/div>')),this.rtl&&(u=n('<div style="float: right; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 0px; top: 50%; margin-left: 0px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-grid-column-sortascbutton")+'"><\/div><\/div>'),f=n('<div style="float: right; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 0px; top: 50%; margin-left: 0px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-grid-column-sortdescbutton")+'"><\/div><\/div>'),this.closeablegroups&&(u=n('<div style="float: right; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 0px; top: 50%; margin-left: 16px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-grid-column-sortascbutton")+'"><\/div><\/div>'),f=n('<div style="float: right; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 0px; top: 50%; margin-left: 16px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-grid-column-sortdescbutton")+'"><\/div><\/div>'))),u.css("display","none"),f.css("display","none"),n.jqx.browser.msie&&n.jqx.browser.version<8&&(u.css("float","left"),f.css("float","left")),r.append(u),r.append(f),n.data(document.body,"groupsortelements"+i,{sortasc:u,sortdesc:f})),r.addClass(this.toThemeProperty("jqx-fill-state-normal")),r.addClass(this.toThemeProperty("jqx-grid-group-column")),r},_rendergroup:function(t,i,r,u,f,e,o){var d=i,ft=i.cells[r.level],g,nt,s,k,a,et,rt,h,c,p,ot,v,st,w,l;this.rtl&&(ft=i.cells[i.cells.length-1-r.level]),g=this._findgroupstate(r.uniqueid),(r.bounddata.subGroups.length>0||r.bounddata.subItems.length>0)&&(nt=this.rtl?"-rtl":"",ft.className+=g?" "+this.toThemeProperty("jqx-grid-group-expand"+nt):" "+this.toThemeProperty("jqx-grid-group-collapse"+nt));var tt=this._getColumnText(this.groups[r.level]).label,b=this.groupindentwidth,y=this.rowdetails&&this.showrowdetailscolumn?(1+t)*b:t*b,l=o-y,it=r.level+1;for(this.rtl&&(it=0),s=d.cells[it],k=2;s!=undefined&&s.style.display=="none"&&k<d.cells.length-1;)s=d.cells[it+k-1],k++;if(a=n(s),s){if(s.style.width=parseInt(l)+"px",s.className.indexOf("jqx-grid-cell-filter")!=-1&&a.removeClass(this.toThemeProperty("jqx-grid-cell-filter")),s.className.indexOf("jqx-grid-cell-sort")!=-1&&a.removeClass(this.toThemeProperty("jqx-grid-cell-sort")),s.className.indexOf("jqx-grid-cell-pinned")!=-1&&a.removeClass(this.toThemeProperty("jqx-grid-cell-pinned")),this.groupsrenderer!=null)et={group:r.group,level:r.level,parent:r.bounddata.parentItem,subGroups:r.bounddata.subGroups,subItems:r.bounddata.subItems,groupcolumn:this._getColumnText(this.groups[r.level]).column},rt=this.groupsrenderer(tt+": "+r.group,r.group,g,et),rt?s.innerHTML=rt:(p=r.bounddata.subItems.length>0?r.bounddata.subItems.length:r.bounddata.subGroups.length,s.innerHTML='<div class="'+this.toThemeProperty("jqx-grid-groups-row")+'" style="position: absolute;"><span>'+tt+': <\/span><span class="'+this.toThemeProperty("jqx-grid-groups-row-details")+'">'+r.group+" ("+p+")<\/span><\/div>");else if(h=this._getcolumnbydatafield(this.groups[r.level]),c=r.group,h!=null)h.cellsformat&&n.jqx.dataFormat&&(n.jqx.dataFormat.isDate(c)?c=n.jqx.dataFormat.formatdate(c,h.cellsformat,this.gridlocalization):n.jqx.dataFormat.isNumber(c)&&(c=n.jqx.dataFormat.formatnumber(c,h.cellsformat,this.gridlocalization))),p=r.bounddata.subItems.length>0?r.bounddata.subItems.length:r.bounddata.subGroups.length,s.innerHTML='<div class="'+this.toThemeProperty("jqx-grid-groups-row")+'" style="position: absolute;"><span>'+tt+': <\/span><span class="'+this.toThemeProperty("jqx-grid-groups-row-details")+'">'+c+" ("+p+")<\/span><\/div>";else throw new Error("jqxGrid: Unable to find '"+this.groups[r.level]+"' group in the Grid's columns collection.");if(this.rtl){h||(h=this._getcolumnbydatafield(this.groups[r.level]));var w=this.hScrollBar.css("visibility")=="hidden"?0:this.hScrollInstance.max-this.hScrollInstance.value,ut=this.vScrollBar.css("visibility")=="hidden"?0:this.scrollbarsize+6,y=this.rowdetails&&this.showrowdetailscolumn?(2+r.level)*b:(1+r.level)*b;s.style.width=o+parseInt(w)-y-ut+"px",a.addClass(this.toThemeProperty("jqx-rtl")),ot=n(i.cells[i.cells.length-1]).css("z-index"),a.css("z-index",ot),v=a.find("div"),l=v.width(),v.css("left","100%"),st=this.columns.records[i.cells.length-2-r.level]!=null?this.columns.records[i.cells.length-2-r.level].pinned:!1,this.table.width()<o&&(o=this.table.width(),this.vScrollBar.css("visibility")!="hidden"&&(o+=this.vScrollBar.outerWidth())),h.pinned||st?(this.rowdetails&&this.showrowdetailscolumn&&(o+=30),v.css("margin-left",-l),s.style.width=o+w-y-ut+"px"):(w=this.hScrollBar.css("visibility")=="hidden"?0:this.hScrollInstance.max,s.style.width=o+w-y-ut+"px",l=v.width(),v.css("margin-left",-l))}}}})})(jQuery);
//# sourceMappingURL=jqxgrid.grouping.min.js.map