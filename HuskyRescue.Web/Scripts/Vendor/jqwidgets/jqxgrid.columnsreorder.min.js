(function(n){n.extend(n.jqx._jqxGrid.prototype,{getcolumnindex:function(n){var t=this.getcolumn(n);return this.columns.records.indexOf(t)},setcolumnindex:function(t,i,r){var u=this.getcolumn(t),f,o,h,l,e,c,a,s;u.pinned||u.hidden||u.checkboxcolumn||u.grouped||(f=this.columns.records.indexOf(u),this.columns.records.splice(f,1),this.columns.records.splice(i,0,u),o=0,h=this.headerZIndex,this.columnsrow.children().detach(),l=this.toThemeProperty("jqx-grid-cell"),l+=" "+this.toThemeProperty("jqx-grid-cell-pinned"),this.filterrow&&(n(this.filterrow.children()[0]).children().detach(),this.filterrow[0].cells=[]),e=this,c=null,e.filterrow!=undefined&&(c=n(e.filterrow.children()[0])),this.columnsrow[0].cells=[],a=!1,n.each(this.columns.records,function(){var i=this.uielement,r,t;e.columnsrow.append(i),e.rtl?i.css("z-index",h++):i.css("z-index",h--),r=this.width,i.css("left",o),e.columnsrow[0].cells[e.columnsrow[0].cells.length]=i[0],e.filterrow&&(t=n('<div style="overflow: hidden; position: absolute; height: 100%;" class="'+l+'"><\/div>'),c.append(t),t.css("left",o),t.css("z-index",h+1),t.width(this.width),t[0].left=o,t.append(this._filterwidget),e.filterrow[0].cells[e.filterrow[0].cells.length]=t[0]),this.hidden&&(a=!0),this.hidden&&this.hideable||(o+=r)}),this.groupable&&(s=this.groups.length,s>0&&f-s>=0&&(f-=s,i-=s)),this.rowdetails&&f-1>=0&&(f--,i--),this.selectionmode=="checkbox"&&f-1>=0&&(f--,i--),u=this._columns[f],this._columns.splice(f,1),this._columns.splice(i,0,u),this._raiseEvent(24,{columntext:u.text,datafield:u.datafield,oldindex:f,newindex:i}),r!=!1)&&(a?(this.prerenderrequired=!0,this.rendergridcontent(!0,!1),this._updatecolumnwidths(),this._updatecellwidths()):(this._updatecolumnwidths(),this._updatecellwidths()),this._updatefilterrowui&&this.filterable&&this.showfilterrow&&this._updatefilterrowui(),this._rendercolumngroups(),this._renderrows(this.virtualsizeinfo))},_pinnedColumnsLength:function(){var t=0;return n.each(this.columns.records,function(){this.pinned&&t++,this.grouped&&t++}),this.selectionmode=="checkbox"&&t++,t},_handlecolumnsreorder:function(){var t=this,i=-1,r=!1;if(t.columnsreorder){var f="mousemove.reorder"+this.element.id,e="mousedown.reorder"+this.element.id,o="mouseup.reorder"+this.element.id,u=!1;this.isTouchDevice()&&this.touchmode!==!0&&(u=!0,f=n.jqx.mobile.getTouchEventName("touchmove")+".reorder"+this.element.id,e=n.jqx.mobile.getTouchEventName("touchstart")+".reorder"+this.element.id,o=n.jqx.mobile.getTouchEventName("touchend")+".reorder"+this.element.id),this.removeHandler(n(document),f),this.addHandler(n(document),f,function(n){var e,f,h,o,v,y,s,p;if(t.resizing)return!0;if(t.reordercolumn!=null){e=parseInt(n.pageX),f=parseInt(n.pageY),u&&(h=t.getTouches(n),o=h[0],o!=undefined&&(e=parseInt(o.pageX),f=parseInt(o.pageY)));var c=t.host.coord(),l=parseInt(c.left),a=parseInt(c.top);if((t.dragmousedownoffset==undefined||t.dragmousedownoffset==null)&&(t.dragmousedownoffset={left:0,top:0}),v=parseInt(e)-parseInt(t.dragmousedownoffset.left),y=parseInt(f)-parseInt(t.dragmousedownoffset.top),t.reordercolumn.css({left:v+"px",top:y+"px"}),r=!1,e>=l&&e<=l+t.host.width()&&f>=a&&f<=a+t.host.height()&&(r=!0),i=-1,r?(t.reordercolumnicon.removeClass(t.toThemeProperty("jqx-grid-dragcancel-icon")),t.reordercolumnicon.addClass(t.toThemeProperty("jqx-grid-drag-icon")),s=t.columnsheader.coord(),p=s.top+t.columnsheader.height(),t.columnsdropline!=null&&(f>=s.top&&f<=p?i=t._handlereordercolumnsdroplines(e):t.columnsdropline.fadeOut("slow"))):(t.columnsdropline!=null&&t.columnsdropline.fadeOut("slow"),t.reordercolumnicon.removeClass(t.toThemeProperty("jqx-grid-drag-icon")),t.reordercolumnicon.addClass(t.toThemeProperty("jqx-grid-dragcancel-icon"))),u)return n.preventDefault(),n.stopPropagation(),!1}}),this.columnsbounds=[],this.removeHandler(n(document),e),this.addHandler(n(document),e,function(){var i,r,u;if(t.resizing)return!0;t.columnsbounds=[],i=t.host.coord().left,r=t.host.coord().top,t.showtoolbar&&(r+=t.toolbarheight),t.groupable&&t.showgroupsheader&&(r+=t.groupsheaderheight),u=0,n.each(t.columns.records,function(){var f=this,e;if(f.hidden)return t.columnsbounds[t.columnsbounds.length]={top:r,column:f,left:i,width:0,height:2+t.rowsheight},!0;u==0&&(i=t.rtl?parseInt(t.host.coord().left)-t.hScrollInstance.max+t.hScrollInstance.value:parseInt(t.host.coord().left)-t.hScrollInstance.value),u++,e=2+t.columnsheight,t.columnshierarchy&&(r=n(f.uielement).coord().top,e=n(f.uielement).height()),t.columnsbounds[t.columnsbounds.length]={top:r,column:f,left:i,width:f.width,height:e},i+=f.width})}),this.removeHandler(n(document),o),this.addHandler(n(document),o,function(f){var y,p,w,c,o,h,l,a,s,e,v;if(t.resizing)return!0;t.__drag=!1,n(document.body).removeClass("jqx-disableselect"),y=parseInt(f.pageX),p=parseInt(f.pageY),u&&(w=t.getTouches(f),c=w[0],y=parseInt(c.pageX),p=parseInt(c.pageY));var b=t.host.coord(),d=parseInt(b.left),k=parseInt(b.top),g=t.groupsheader.height();if(t.showtoolbar&&(k+=t.toolbarheight),t.columndragstarted=!1,t.dragmousedown=null,t.reordercolumn!=null&&(o=n.data(t.reordercolumn[0],"reorderrecord"),h=t.columns.records.indexOf(t.getcolumn(o)),t.reordercolumn.remove(),t.reordercolumn=null,l=0,l+=t._pinnedColumnsLength(),o!=null)){if(r&&i!=-1&&(a=i.index,a>=l&&(s=t.columns.records[a],s!=undefined))){if(e=t.columns.records.indexOf(t.getcolumn(s.datafield)),s.datafield==null&&(e=t.columns.records.indexOf(t.getcolumnbytext(s.text))),t.columngroups&&(v=s,h<e&&i.position=="before"&&(v=t.columns.records[e-1]),v.columngroup!=t.getcolumn(o).columngroup)){t.columnsdropline!=null&&(t.columnsdropline.remove(),t.columnsdropline=null);return}h<e?i.position=="before"?t.setcolumnindex(o,e-1):t.setcolumnindex(o,e):h>e&&t.setcolumnindex(o,e),t.autosavestate&&t.savestate&&t.savestate()}t.columnsdropline!=null&&(t.columnsdropline.remove(),t.columnsdropline=null)}})}},getcolumnbytext:function(t){var i=null;return this.columns.records&&n.each(this.columns.records,function(){if(this.text==t)return i=this,!1}),i},_handlereordercolumnsdroplines:function(t){var i=this,r=-1,e=i._pinnedColumnsLength(),o=parseInt(i.host.coord().left),f=o+i.host.width(),u=i.vScrollBar.css("visibility")!="hidden"?19:0;return i.rtl||(u=0),n.each(i.columnsbounds,function(n){if(n>=e){if(this.width==0)return!0;if(t<=this.left+this.width/2)return t>f?(i.columnsdropline.fadeOut(),!1):(i.columnsdropline.css("left",u+parseInt(this.left)+"px"),i.columnsdropline.css("top",parseInt(this.top)+"px"),i.columnsdropline.height(this.height),i.columnsdropline.fadeIn("slow"),r={index:n,position:"before"},!1);if(t>=this.left+this.width/2){if(this.left+this.width>f)return i.columnsdropline.fadeOut(),!1;i.columnsdropline.css("left",u+1+this.left+this.width),i.columnsdropline.css("top",this.top),i.columnsdropline.height(this.height),i.columnsdropline.fadeIn("slow"),r={index:n,position:"after"}}}}),r},_createreordercolumn:function(t,i,r){var u=this,s=i,f,e,o,h;u.reordercolumn&&u.reordercolumn.remove(),u.columnsdropline&&u.columnsdropline.remove(),u.reordercolumn=n("<div><\/div>"),f=t.clone(),u.reordercolumn.css("z-index",999999),f.css("border-width","1px"),f.css("opacity","0.4"),e=n(f.find("."+u.toThemeProperty("jqx-grid-column-menubutton"))),e.length>0&&e.css("display","none"),o=n(f.find(".jqx-icon-close")),o.length>0&&o.css("display","none"),u.reordercolumnicon=n('<div style="z-index: 9999; position: absolute; left: 100%; top: 50%; margin-left: -18px; margin-top: -7px;"><\/div>'),u.reordercolumnicon.addClass(u.toThemeProperty("jqx-grid-drag-icon")),u.reordercolumn.css("float","left"),u.reordercolumn.css("position","absolute"),h=u.host.coord(),f.width(t.width()+16),u.reordercolumn.append(f),u.reordercolumn.height(t.height()),u.reordercolumn.width(f.width()),u.reordercolumn.append(u.reordercolumnicon),n(document.body).append(u.reordercolumn),f.css("margin-left",0),f.css("left",0),f.css("top",0),u.reordercolumn.css("left",s.left+u.dragmousedown.left),u.reordercolumn.css("top",s.top+u.dragmousedown.top),r!=undefined&&r&&(u.columnsdropline=n('<div style="z-index: 9999; display: none; position: absolute;"><\/div>'),u.columnsdropline.width(2),u.columnsdropline.addClass(u.toThemeProperty("jqx-grid-group-drag-line")),n(document.body).append(u.columnsdropline))},_handlecolumnsdragreorder:function(t,i){var r,f,e,u;this.reordercolumn&&this.reordercolumn.remove(),this.columnsdropline&&this.columnsdropline.remove(),this.dragmousedown=null,this.dragmousedownoffset=null,this.columndragstarted=!1,this.reordercolumn=null,r=this,f=!1,this.isTouchDevice()&&this.touchmode!==!0&&(f=!0),e="mousedown.drag",u="mousemove.drag",f?(e=n.jqx.mobile.getTouchEventName("touchstart")+".drag",u=n.jqx.mobile.getTouchEventName("touchmove")+".drag"):this.addHandler(i,"dragstart",function(){return!1}),this.addHandler(i,e,function(i){var u,e,h,o,s;return!1==t.draggable?!0:r.resizing?!0:(r.__drag=!0,u=i.pageX,e=i.pageY,f&&(h=r.getTouches(i),o=h[0],u=o.pageX,e=o.pageY),r.dragmousedown={left:u,top:e},s=n(i.target).coord(),r.dragmousedownoffset={left:parseInt(u)-parseInt(s.left),top:parseInt(e-s.top)},!0)}),this.addHandler(i,u,function(e){var s,h,c,o,l,a;if(!t.draggable||undefined==t.datafield||t.pinned||r.resizing)return!0;r.dragmousedown&&(s=e.pageX,h=e.pageY,f&&(c=r.getTouches(e),o=c[0],o!=undefined&&(s=o.pageX,h=o.pageY)),u={left:s,top:h},r.columndragstarted||r.reordercolumn!=null||(l=Math.abs(u.left-r.dragmousedown.left),a=Math.abs(u.top-r.dragmousedown.top),(l>3||a>3)&&(r._createreordercolumn(i,u,!0),n(document.body).addClass("jqx-disableselect"),n.data(r.reordercolumn[0],"reorderrecord",t.datafield))))})}})})(jQuery);
//# sourceMappingURL=jqxgrid.columnsreorder.min.js.map