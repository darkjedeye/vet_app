(function(n){n.extend(n.jqx._jqxGrid.prototype,{exportdata:function(t,i,r,u,f,e,o){var h,u,b,l,v,ut,g,nt,ot;if(!n.jqx.dataAdapter.ArrayExporter)throw"jqxGrid: Missing reference to jqxdata.export.js!";if(r==undefined&&(r=!0),h=this,u==undefined&&(u=this.getrows(),u.length==0))throw"No data to export.";this.exporting=!0,this.altrows&&this._renderrows(this.virtualsizeinfo);var tt=f!=undefined?f:!1,c={},s={},p=this.host.find(".jqx-grid-cell:first"),w=this.host.find(".jqx-grid-cell-alt:first");p.removeClass(this.toThemeProperty("jqx-grid-cell-selected")),p.removeClass(this.toThemeProperty("jqx-fill-state-pressed")),w.removeClass(this.toThemeProperty("jqx-grid-cell-selected")),w.removeClass(this.toThemeProperty("jqx-fill-state-pressed")),p.removeClass(this.toThemeProperty("jqx-grid-cell-hover")),p.removeClass(this.toThemeProperty("jqx-fill-state-hover")),w.removeClass(this.toThemeProperty("jqx-grid-cell-hover")),w.removeClass(this.toThemeProperty("jqx-fill-state-hover"));var y="cell",k=1,it="column",rt=1,d=[];for(b=0;b<this.columns.records.length;b++)if(l=this.columns.records[b],l.cellclassname!="")if(l.customCellStyles=[],typeof l.cellclassname=="string")l.customCellStyles.push(l.cellclassname);else for(v=0;v<u.length;v++)ut=this.getrowboundindex(v),g=l.cellclassname(ut,l.displayfield,u[v][l.displayfield]),g&&(l.customCellStyles[v]=g);if(n.each(this.columns.records,function(i){var o=n(h.table[0].rows[0].cells[i]),a,f,v,p,w,l,e;if(h.table[0].rows.length>1&&(a=n(h.table[0].rows[1].cells[i])),f=this,v=function(n){if(n.removeClass(h.toThemeProperty("jqx-grid-cell-selected")),n.removeClass(h.toThemeProperty("jqx-fill-state-pressed")),n.removeClass(h.toThemeProperty("jqx-grid-cell-hover")),n.removeClass(h.toThemeProperty("jqx-fill-state-hover")),f.customCellStyles)for(var t in f.customCellStyles)n.removeClass(f.customCellStyles[t])},v(o),a&&v(a),this.displayfield==null)return!0;if(h.showaggregates&&h.getcolumnaggregateddata&&d.push(h.getcolumnaggregateddata(this.displayfield,this.aggregates,!0,u)),p=h._getexportcolumntype(this),this.exportable&&(!this.hidden||tt)&&(c[this.displayfield]={},c[this.displayfield].text=this.text,c[this.displayfield].width=parseInt(this.width),isNaN(c[this.displayfield].width)&&(c[this.displayfield].width=60),c[this.displayfield].formatString=this.cellsformat,c[this.displayfield].localization=h.gridlocalization,c[this.displayfield].type=p,c[this.displayfield].cellsAlign=this.cellsalign,c[this.displayfield].hidden=!r),y="cell"+k,w=n(this.element),this.element==undefined&&(w=n(this.uielement)),it="column"+rt,t=="html"||t=="xls"||t=="pdf"){if(l=function(n,i,r,u,f,e,o,h,l){s[n]={},s[n]["font-size"]=i.css("font-size"),s[n]["font-weight"]=i.css("font-weight"),s[n]["font-style"]=i.css("font-style"),s[n]["background-color"]=e._getexportcolor(i.css("background-color")),s[n].color=e._getexportcolor(i.css("color")),s[n]["border-color"]=e._getexportcolor(i.css("border-top-color")),r?s[n]["text-align"]=f.align:(s[n]["text-align"]=f.cellsalign,s[n].formatString=f.cellsformat,s[n].dataType=p),(t=="html"||t=="pdf")&&(s[n]["border-top-width"]=i.css("border-top-width"),s[n]["border-left-width"]=i.css("border-left-width"),s[n]["border-right-width"]=i.css("border-right-width"),s[n]["border-bottom-width"]=i.css("border-bottom-width"),s[n]["border-top-style"]=i.css("border-top-style"),s[n]["border-left-style"]=i.css("border-left-style"),s[n]["border-right-style"]=i.css("border-right-style"),s[n]["border-bottom-style"]=i.css("border-bottom-style"),r?(o==0&&(s[n]["border-left-width"]=i.css("border-right-width")),s[n]["border-top-width"]=i.css("border-right-width"),s[n]["border-bottom-width"]=i.css("border-bottom-width")):o==0&&(s[n]["border-left-width"]=i.css("border-right-width")),s[n].height=i.css("height")),f.exportable&&(!f.hidden||tt)&&(h==!0?(c[f.displayfield].customCellStyles||(c[f.displayfield].customCellStyles=[]),c[f.displayfield].customCellStyles[l]=n):r?c[f.displayfield].style=n:u?c[f.displayfield].cellAltStyle=n:c[f.displayfield].cellStyle=n)},l(it,w,!0,!1,this,h,i),rt++,l(y,o,!1,!1,this,h,i),h.altrows&&(y="cellalt"+k,l(y,a,!1,!0,this,h,i)),this.customCellStyles){for(e in f.customCellStyles)o.removeClass(f.customCellStyles[e]);for(e in f.customCellStyles)o.addClass(f.customCellStyles[e]),l(y+f.customCellStyles[e],o,!1,!1,this,h,i,!0,e),o.removeClass(f.customCellStyles[e])}k++}}),this.showaggregates){var a=[],ft=t=="xls"?"AG":"",et=this.groupable?this.groups.length:0;this.rowdetails&&et++,d.length>0&&(n.each(this.columns.records,function(n){var t;if(this.aggregates)for(t=0;t<this.aggregates.length;t++)if(a[t]||(a[t]={}),a[t]){var r=h._getaggregatename(this.aggregates[t]),u=h._getaggregatetype(this.aggregates[t]),i=d[n-et];i&&(a[t][this.displayfield]=ft+r+": "+i[u])}}),n.each(this.columns.records,function(){for(var n=0;n<a.length;n++)a[n][this.displayfield]==undefined&&(a[n][this.displayfield]=ft)})),n.each(a,function(){u.push(this)})}if(nt=n.jqx.dataAdapter.ArrayExporter(u,c,s),i==undefined)return this._renderrows(this.virtualsizeinfo),ot=nt.exportTo(t),this.showaggregates&&n.each(a,function(){u.pop(this)}),this.exporting=!1,ot;nt.exportToFile(t,i,e,o),this.showaggregates&&n.each(a,function(){u.pop(this)}),this._renderrows(this.virtualsizeinfo),this.exporting=!1},_getexportcolor:function(n){var t=n,i,s;if(n=="transparent"&&(t="#FFFFFF"),t&&t.toString()||(t="#FFFFFF"),t.toString().indexOf("rgb")!=-1){if(i=t.split(","),t.toString().indexOf("rgba")!=-1){var r=parseInt(i[0].substring(5)),u=parseInt(i[1]),f=parseInt(i[2]),h=parseInt(i[3].substring(1,4)),e={r:r,g:u,b:f},o=this._rgbToHex(e);return r==0&&u==0&&f==0&&h==0?"#ffffff":"#"+o}var r=parseInt(i[0].substring(4)),u=parseInt(i[1]),f=parseInt(i[2].substring(1,4)),e={r:r,g:u,b:f},o=this._rgbToHex(e);return"#"+o}return t.toString().indexOf("#")!=-1&&t.toString().length==4&&(s=t.toString().substring(1,4),t+=s),t},_rgbToHex:function(n){return this._intToHex(n.r)+this._intToHex(n.g)+this._intToHex(n.b)},_intToHex:function(n){var t=parseInt(n).toString(16);return t.length==1&&(t="0"+t),t.toUpperCase()},_getexportcolumntype:function(t){var e=this,u="string",o=e.source.datafields||(e.source._source?e.source._source.datafields:null),f,i,r,s;if(o&&(f="",n.each(o,function(){if(this.name==t.displayfield)return this.type&&(f=this.type),!1}),f))return f;if(t!=null){if(this.dataview.cachedrecords==undefined)return u;if(i=null,this.virtualmode)n.each(this.dataview.cachedrecords,function(){return i=this[t.displayfield],!1});else{if(this.dataview.cachedrecords.length==0)return u;if(i=this.dataview.cachedrecords[0][t.displayfield],i!=null&&i.toString()=="")return"string"}if(i!=null){if(t.cellsformat.indexOf("c")!=-1||t.cellsformat.indexOf("n")!=-1||t.cellsformat.indexOf("p")!=-1)return"number";if(t.cellsformat.indexOf("d")!=-1||t.cellsformat.indexOf("y")!=-1||t.cellsformat.indexOf("M")!=-1||t.cellsformat.indexOf("m")!=-1||t.cellsformat.indexOf("t")!=-1)return"date";if(typeof i=="boolean")u="boolean";else if(n.jqx.dataFormat.isNumber(i))u="number";else if(r=new Date(i),r.toString()=="NaN"||r.toString()=="Invalid Date")if(n.jqx.dataFormat){if(r=n.jqx.dataFormat.tryparsedate(i),r!=null)return r&&r.getFullYear()&&r.getFullYear()==1970&&r.getMonth()==0&&r.getDate()==1?(s=new Number(i),!isNaN(s))?"number":"string":"date";u="string"}else u="string";else u="date"}}return u}})})(jQuery);
//# sourceMappingURL=jqxgrid.export.min.js.map