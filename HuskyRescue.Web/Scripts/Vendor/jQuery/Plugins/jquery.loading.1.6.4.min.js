(function(n){function u(n,t){return t===undefined?t=typeof n=="boolean"?{show:n}:n:t.show=n,t&&(t.img||t.element)&&!t.pulse&&(t.pulse=!1),t&&t.onAjax!==undefined&&t.show===undefined&&(t.show=!1),t}function t(n,t){var i=n.css(t);return i=="auto"?0:parseFloat(i,10)}var i=n.loading=function(t,i){return n("body").loading(t,i,!0)},r;n.fn.loading=function(t,r,f){r=u(t,r);var e=f?n.extend(!0,{},i,i.pageOptions):i;return this.each(function(){var t=n(this),u=n.extend(!0,{},e,n.metadata?t.metadata():null,r);typeof u.onAjax=="boolean"?i.setAjax.call(t,u):i.toggle.call(t,u)})},r={position:n.browser.msie?"absolute":"fixed"},n.extend(i,{version:"1.6.4",align:"top-left",pulse:"working error",mask:!1,img:null,element:null,text:"Loading...",onAjax:undefined,delay:0,max:0,classname:"loading",imgClass:"loading-img",elementClass:"loading-element",maskClass:"loading-mask",css:{position:"absolute",whiteSpace:"nowrap",zIndex:1001},maskCss:{position:"absolute",opacity:.15,background:"#333",zIndex:101,display:"block",cursor:"wait"},cloneEvents:!0,pageOptions:{page:!0,align:"top-center",css:r,maskCss:r},html:"<div><\/div>",maskHtml:"<div><\/div>",maskedClass:"loading-masked",maskEvents:"mousedown mouseup keydown keypress",resizeEvents:"resize",working:{time:1e4,text:"Still working...",run:function(n){var t=n.working,i=this;t.timeout=setTimeout(function(){i.height("auto").width("auto").text(n.text=t.text),n.place.call(i,n)},t.time)}},error:{time:1e5,text:"Task may have failed...",classname:"loading-error",run:function(n){var t=n.error,i=this;t.timeout=setTimeout(function(){i.height("auto").width("auto").text(n.text=t.text).addClass(t.classname),n.place.call(i,n)},t.time)}},fade:{time:800,speed:"slow",run:function(n){var t=n.fade,i=t.speed,r=this;t.interval=setInterval(function(){r.fadeOut(i).fadeIn(i)},t.time)}},ellipsis:{time:300,run:function(n){function r(n){var t=n.indexOf(".");return t<0?n.length:t}var t=n.ellipsis,i=this;t.interval=setInterval(function(){var t=i.text(),u=n.text,f=r(u);i.text(t.length-f<3?t+".":u.substring(0,f))},t.time)}},type:{time:100,run:function(n){var t=n.type,i=this;t.interval=setInterval(function(){var u=i.text(),r=u.length,t=n.text;i.text(r==t.length?t.charAt(0):t.substring(0,r+1))},t.time)}},toggle:function(n){var t=this.data("loading");t?n.show!==!0&&t.off.call(this,t,n):n.show!==!1&&n.on.call(this,n)},setAjax:function(n){if(n.onAjax){var t=this,i=0,r=n.ajax={start:function(){i++||n.on.call(t,n)},stop:function(){--i||n.off.call(t,n,n)}};this.bind("ajaxStart.loading",r.start).bind("ajaxStop.loading",r.stop)}else this.unbind("ajaxStart.loading ajaxStop.loading")},on:function(n,t){var i=n.parent=this.data("loading",n);if(n.max&&(n.maxout=setTimeout(function(){n.off.call(i,n,n)},n.max)),n.delay&&!t)return n.timeout=setTimeout(function(){delete n.timeout,n.on.call(i,n,!0)},n.delay);n.mask&&(n.mask=n.createMask.call(i,n)),n.display=n.create.call(i,n),n.img?n.initImg.call(i,n):n.element?n.initElement.call(i,n):n.init.call(i,n),i.trigger("loadingStart",[n])},initImg:function(t){var i=this;t.imgElement=n('<img src="'+t.img+'"/>').bind("load",function(){t.init.call(i,t)}),t.display.addClass(t.imgClass).append(t.imgElement)},initElement:function(t){t.element=n(t.element).clone(t.cloneEvents).show(),t.display.addClass(t.elementClass).append(t.element),t.init.call(this,t)},init:function(n){n.place.call(n.display,n),n.pulse&&n.initPulse.call(this,n)},initPulse:function(t){n.each(t.pulse.split(" "),function(){t[this].run.call(t.display,t)})},create:function(t){var i=n(t.html).addClass(t.classname).css(t.css).appendTo(this);return!t.text||t.img||t.element||i.text(t.originalText=t.text),n(window).bind(t.resizeEvents,t.resizer=function(){t.resize(t)}),i},resize:function(n){n.parent.box=null,n.mask&&n.mask.hide(),n.place.call(n.display.hide(),n),n.mask&&n.mask.show().css(n.parent.box)},createMask:function(t){var i=t.measure.call(this.addClass(t.maskedClass),t);return t.handler=function(n){return t.maskHandler(n,t)},n(document).bind(t.maskEvents,t.handler),n(t.maskHtml).addClass(t.maskClass).css(i).css(t.maskCss).appendTo(this)},maskHandler:function(t,i){var r=n(t.target).parents().andSelf();return r.filter("."+i.classname).length!=0?!0:!i.page&&r.filter("."+i.maskedClass).length==0},place:function(t){var i=t.align,r="top",u="left",f;typeof i=="object"?i=n.extend(t.calc.call(this,r,u,t),i):(i!="top-left"&&(f=i.split("-"),f.length==1?r=u=f[0]:(r=f[0],u=f[1])),this.hasClass(r)||this.addClass(r),this.hasClass(u)||this.addClass(u),i=t.calc.call(this,r,u,t)),this.show().css(t.box=i)},calc:function(i,r,u){var e=n.extend({},u.measure.call(u.parent,u)),o=n.boxModel?this.height():this.innerHeight(),s=n.boxModel?this.width():this.innerWidth(),f;return i!="top"&&(f=e.height-o,i=="center"?f/=2:i!="bottom"?f=0:n.boxModel&&(f-=t(this,"paddingTop")+t(this,"paddingBottom")),e.top+=f),r!="left"&&(f=e.width-s,r=="center"?f/=2:r!="right"?f=0:n.boxModel&&(f-=t(this,"paddingLeft")+t(this,"paddingRight")),e.left+=f),e.height=o,e.width=s,e},measure:function(n){return this.box||(this.box=n.page?n.pageBox(n):n.elementBox(this,n))},elementBox:function(n){var i;return n.css("position")=="absolute"?i={top:0,left:0}:(i=n.position(),i.top+=t(n,"marginTop"),i.left+=t(n,"marginLeft")),i.height=n.outerHeight(),i.width=n.outerWidth(),i},pageBox:function(i){function u(i,r){var u=document,f;if(i){var e=r.toLowerCase(),o=n(u)[e](),s=n(window)[e]();return o-t(n(u.body),"marginTop")>s?o:s}return f="client"+r,Math.max(u.documentElement[f],u.body[f])}var r=n.boxModel&&i.css.position!="fixed";return{top:0,left:0,height:u(r,"Height"),width:u(r,"Width")}},off:function(t,i){if(this.data("loading",null),t.maxout&&clearTimeout(t.maxout),t.timeout)return clearTimeout(t.timeout);t.pulse&&t.stopPulse.call(this,t,i),t.originalText&&(t.text=t.originalText),t.mask&&t.stopMask.call(this,t,i),n(window).unbind(t.resizeEvents,t.resizer),t.display&&t.display.remove(),t.parent&&t.parent.trigger("loadingEnd",[t])},stopPulse:function(t,i){n.each(t.pulse.split(" "),function(){var n=t[this];n.end&&n.end.call(i.display,t,i),n.interval&&clearInterval(n.interval),n.timeout&&clearTimeout(n.timeout)})},stopMask:function(t,i){this.removeClass(i.maskedClass),n(document).unbind(t.maskEvents,t.handler),t.mask.remove()}})})(jQuery);
//# sourceMappingURL=jquery.loading.1.6.4.min.js.map