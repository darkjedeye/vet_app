(function(n){n.widget("ui.selectmenu",{options:{appendTo:"body",typeAhead:1e3,style:"dropdown",positionOptions:null,width:null,menuWidth:null,handleWidth:26,maxHeight:null,icons:null,format:null,escapeHtml:!1,bgImage:function(){}},_create:function(){var t=this,i=this.options,r=this.element.uniqueId().attr("id"),u;this.ids=[r,r+"-button",r+"-menu"],this._safemouseup=!0,this.isOpen=!1,this.newelement=n("<a />",{"class":"ui-selectmenu ui-widget ui-state-default ui-corner-all",id:this.ids[1],role:"button",href:"#nogo",tabindex:this.element.attr("disabled")?1:0,"aria-haspopup":!0,"aria-owns":this.ids[2]}),this.newelementWrap=n("<span />").append(this.newelement).insertAfter(this.element),u=this.element.attr("tabindex"),u&&this.newelement.attr("tabindex",u),this.newelement.data("selectelement",this.element),this.selectmenuIcon=n('<span class="ui-selectmenu-icon ui-icon"><\/span>').prependTo(this.newelement),this.newelement.prepend('<span class="ui-selectmenu-status" />'),this.element.bind({"click.selectmenu":function(n){t.newelement.focus(),n.preventDefault()}}),this.newelement.bind("mousedown.selectmenu",function(n){t._toggle(n,!0),i.style=="popup"&&(t._safemouseup=!1,setTimeout(function(){t._safemouseup=!0},300)),n.preventDefault()}).bind("click.selectmenu",function(n){n.preventDefault()}).bind("keydown.selectmenu",function(i){var r=!1;switch(i.keyCode){case n.ui.keyCode.ENTER:r=!0;break;case n.ui.keyCode.SPACE:t._toggle(i);break;case n.ui.keyCode.UP:i.altKey?t.open(i):t._moveSelection(-1);break;case n.ui.keyCode.DOWN:i.altKey?t.open(i):t._moveSelection(1);break;case n.ui.keyCode.LEFT:t._moveSelection(-1);break;case n.ui.keyCode.RIGHT:t._moveSelection(1);break;case n.ui.keyCode.TAB:r=!0;break;case n.ui.keyCode.PAGE_UP:case n.ui.keyCode.HOME:t.index(0);break;case n.ui.keyCode.PAGE_DOWN:case n.ui.keyCode.END:t.index(t._optionLis.length);break;default:r=!0}return r}).bind("keypress.selectmenu",function(n){return n.which>0&&t._typeAhead(n.which,"mouseup"),!0}).bind("mouseover.selectmenu",function(){i.disabled||n(this).addClass("ui-state-hover")}).bind("mouseout.selectmenu",function(){i.disabled||n(this).removeClass("ui-state-hover")}).bind("focus.selectmenu",function(){i.disabled||n(this).addClass("ui-state-focus")}).bind("blur.selectmenu",function(){i.disabled||n(this).removeClass("ui-state-focus")}),n(document).bind("mousedown.selectmenu-"+this.ids[0],function(n){t.isOpen&&t.ids[1]!=n.target.offsetParent.id&&t.close(n)}),this.element.bind("click.selectmenu",function(){t._refreshValue()}).bind("focus.selectmenu",function(){t.newelement&&t.newelement[0].focus()}),i.width||(i.width=this.element.outerWidth()),this.newelement.width(i.width),this.element.hide(),this.list=n("<ul />",{"class":"ui-widget ui-widget-content","aria-hidden":!0,role:"listbox","aria-labelledby":this.ids[1],id:this.ids[2]}),this.listWrap=n("<div />",{"class":"ui-selectmenu-menu"}).append(this.list).appendTo(i.appendTo),this.list.bind("keydown.selectmenu",function(i){var r=!1;switch(i.keyCode){case n.ui.keyCode.UP:i.altKey?t.close(i,!0):t._moveFocus(-1);break;case n.ui.keyCode.DOWN:i.altKey?t.close(i,!0):t._moveFocus(1);break;case n.ui.keyCode.LEFT:t._moveFocus(-1);break;case n.ui.keyCode.RIGHT:t._moveFocus(1);break;case n.ui.keyCode.HOME:t._moveFocus(":first");break;case n.ui.keyCode.PAGE_UP:t._scrollPage("up");break;case n.ui.keyCode.PAGE_DOWN:t._scrollPage("down");break;case n.ui.keyCode.END:t._moveFocus(":last");break;case n.ui.keyCode.ENTER:case n.ui.keyCode.SPACE:t.close(i,!0),n(i.target).parents("li:eq(0)").trigger("mouseup");break;case n.ui.keyCode.TAB:r=!0,t.close(i,!0),n(i.target).parents("li:eq(0)").trigger("mouseup");break;case n.ui.keyCode.ESCAPE:t.close(i,!0);break;default:r=!0}return r}).bind("keypress.selectmenu",function(n){return n.which>0&&t._typeAhead(n.which,"focus"),!0}).bind("mousedown.selectmenu mouseup.selectmenu",function(){return!1}),n(window).bind("resize.selectmenu-"+this.ids[0],n.proxy(t.close,this))},_init:function(){var i=this,u=this.options,r=[],h,t,c,o,a,f,s,l,v,e;if(this.element.find("option").each(function(){var t=n(this);r.push({value:t.attr("value"),text:i._formatText(t.text(),t),selected:t.attr("selected"),disabled:t.attr("disabled"),classes:t.attr("class"),typeahead:t.attr("typeahead"),parentOptGroup:t.parent("optgroup"),bgImage:u.bgImage.call(t)})}),h=i.options.style=="popup"?" ui-state-active":"",this.list.html(""),r.length){for(t=0;t<r.length;t++)if(c={role:"presentation"},r[t].disabled&&(c["class"]="ui-state-disabled"),o={html:r[t].text||"&nbsp;",href:"#nogo",tabindex:-1,role:"option","aria-selected":!1},r[t].disabled&&(o["aria-disabled"]=r[t].disabled),r[t].typeahead&&(o.typeahead=r[t].typeahead),a=n("<a/>",o).bind("focus.selectmenu",function(){n(this).parent().mouseover()}).bind("blur.selectmenu",function(){n(this).parent().mouseout()}),f=n("<li/>",c).append(a).data("index",t).addClass(r[t].classes).data("optionClasses",r[t].classes||"").bind("mouseup.selectmenu",function(t){return!i._safemouseup||i._disabled(t.currentTarget)||i._disabled(n(t.currentTarget).parents("ul > li.ui-selectmenu-group "))||(i.index(n(this).data("index")),i.select(t),i.close(t,!0)),!1}).bind("click.selectmenu",function(){return!1}).bind("mouseover.selectmenu",function(t){n(this).hasClass("ui-state-disabled")||n(this).parent("ul").parent("li").hasClass("ui-state-disabled")||(t.optionValue=i.element[0].options[n(this).data("index")].value,i._trigger("hover",t,i._uiHash()),i._selectedOptionLi().addClass(h),i._focusedOptionLi().removeClass("ui-selectmenu-item-focus ui-state-hover"),n(this).removeClass("ui-state-active").addClass("ui-selectmenu-item-focus ui-state-hover"))}).bind("mouseout.selectmenu",function(t){n(this).is(i._selectedOptionLi())&&n(this).addClass(h),t.optionValue=i.element[0].options[n(this).data("index")].value,i._trigger("blur",t,i._uiHash()),n(this).removeClass("ui-selectmenu-item-focus ui-state-hover")}),r[t].parentOptGroup.length?(s="ui-selectmenu-group-"+this.element.find("optgroup").index(r[t].parentOptGroup),this.list.find("li."+s).length?this.list.find("li."+s+":last ul").append(f):n('<li role="presentation" class="ui-selectmenu-group '+s+(r[t].parentOptGroup.attr("disabled")?' ui-state-disabled" aria-disabled="true"':'"')+'><span class="ui-selectmenu-group-label">'+r[t].parentOptGroup.attr("label")+"<\/span><ul><\/ul><\/li>").appendTo(this.list).find("ul").append(f)):f.appendTo(this.list),u.icons)for(l in u.icons)f.is(u.icons[l].find)&&(f.data("optionClasses",r[t].classes+" ui-selectmenu-hasIcon").addClass("ui-selectmenu-hasIcon"),v=u.icons[l].icon||"",f.find("a:eq(0)").prepend('<span class="ui-selectmenu-item-icon ui-icon '+v+'"><\/span>'),r[t].bgImage&&f.find("span").css("background-image",r[t].bgImage))}else n(' <li role="presentation"><a href="#nogo" tabindex="-1" role="option"><\/a><\/li>').appendTo(this.list);e=u.style=="dropdown",this.newelement.toggleClass("ui-selectmenu-dropdown",e).toggleClass("ui-selectmenu-popup",!e),this.list.toggleClass("ui-selectmenu-menu-dropdown ui-corner-bottom",e).toggleClass("ui-selectmenu-menu-popup ui-corner-all",!e).find("li:first").toggleClass("ui-corner-top",!e).end().find("li:last").addClass("ui-corner-bottom"),this.selectmenuIcon.toggleClass("ui-icon-triangle-1-s",e).toggleClass("ui-icon-triangle-2-n-s",!e),u.style=="dropdown"?this.list.width(u.menuWidth?u.menuWidth:u.width):this.list.width(u.menuWidth?u.menuWidth:u.width-u.handleWidth),this.list.css("height","auto");var w=this.listWrap.height(),y=n(window).height(),p=u.maxHeight?Math.min(u.maxHeight,y):y/3;w>p&&this.list.height(p),this._optionLis=this.list.find("li:not(.ui-selectmenu-group)"),this.element.attr("disabled")?this.disable():this.enable(),this._refreshValue(),this._selectedOptionLi().addClass("ui-selectmenu-item-focus"),clearTimeout(this.refreshTimeout),this.refreshTimeout=window.setTimeout(function(){i._refreshPosition()},200)},destroy:function(){this.element.removeData(this.widgetName).removeClass("ui-selectmenu-disabled ui-state-disabled").removeAttr("aria-disabled").unbind(".selectmenu"),n(window).unbind(".selectmenu-"+this.ids[0]),n(document).unbind(".selectmenu-"+this.ids[0]),this.newelementWrap.remove(),this.listWrap.remove(),this.element.unbind(".selectmenu").show(),n.Widget.prototype.destroy.apply(this,arguments)},_typeAhead:function(n,t){var i=this,e=String.fromCharCode(n).toLowerCase(),f=null,u=null,o,r,s;for(i._typeAhead_timer&&(window.clearTimeout(i._typeAhead_timer),i._typeAhead_timer=undefined),i._typeAhead_chars=(i._typeAhead_chars===undefined?"":i._typeAhead_chars).concat(e),i._typeAhead_chars.length<2||i._typeAhead_chars.substr(-2,1)===e&&i._typeAhead_cycling?(i._typeAhead_cycling=!0,f=e):(i._typeAhead_cycling=!1,f=i._typeAhead_chars),o=(t!=="focus"?this._selectedOptionLi().data("index"):this._focusedOptionLi().data("index"))||0,r=0;r<this._optionLis.length;r++)if(s=this._optionLis.eq(r).text().substr(0,f.length).toLowerCase(),s===f)if(i._typeAhead_cycling){if(u===null&&(u=r),r>o){u=r;break}}else u=r;u!==null&&this._optionLis.eq(u).find("a").trigger(t),i._typeAhead_timer=window.setTimeout(function(){i._typeAhead_timer=undefined,i._typeAhead_chars=undefined,i._typeAhead_cycling=undefined},i.options.typeAhead)},_uiHash:function(){var t=this.index();return{index:t,option:n("option",this.element).get(t),value:this.element[0].value}},open:function(n){if(this.newelement.attr("aria-disabled")!="true"){var t=this,u=this.options,i=this._selectedOptionLi(),r=i.find("a");t._closeOthers(n),t.newelement.addClass("ui-state-active"),t.list.attr("aria-hidden",!1),t.listWrap.addClass("ui-selectmenu-open"),u.style=="dropdown"?t.newelement.removeClass("ui-corner-all").addClass("ui-corner-top"):this.list.css("left",-5e3).scrollTop(this.list.scrollTop()+i.position().top-this.list.outerHeight()/2+i.outerHeight()/2).css("left","auto"),t._refreshPosition(),r.length&&r[0].focus(),t.isOpen=!0,t._trigger("open",n,t._uiHash())}},close:function(n,t){this.newelement.is(".ui-state-active")&&(this.newelement.removeClass("ui-state-active"),this.listWrap.removeClass("ui-selectmenu-open"),this.list.attr("aria-hidden",!0),this.options.style=="dropdown"&&this.newelement.removeClass("ui-corner-top").addClass("ui-corner-all"),t&&this.newelement.focus(),this.isOpen=!1,this._trigger("close",n,this._uiHash()))},change:function(n){this.element.trigger("change"),this._trigger("change",n,this._uiHash())},select:function(n){if(this._disabled(n.currentTarget))return!1;this._trigger("select",n,this._uiHash())},widget:function(){return this.listWrap.add(this.newelementWrap)},_closeOthers:function(t){n(".ui-selectmenu.ui-state-active").not(this.newelement).each(function(){n(this).data("selectelement").selectmenu("close",t)}),n(".ui-selectmenu.ui-state-hover").trigger("mouseout")},_toggle:function(n,t){this.isOpen?this.close(n,t):this.open(n)},_formatText:function(t,i){return this.options.format?t=this.options.format(t,i):this.options.escapeHtml&&(t=n("<div />").text(t).html()),t},_selectedIndex:function(){return this.element[0].selectedIndex},_selectedOptionLi:function(){return this._optionLis.eq(this._selectedIndex())},_focusedOptionLi:function(){return this.list.find(".ui-selectmenu-item-focus")},_moveSelection:function(n,t){if(!this.options.disabled){var r=parseInt(this._selectedOptionLi().data("index")||0,10),i=r+n;if(i<0&&(i=0),i>this._optionLis.size()-1&&(i=this._optionLis.size()-1),i===t)return!1;this._optionLis.eq(i).hasClass("ui-state-disabled")?(n>0?++n:--n,this._moveSelection(n,i)):this._optionLis.eq(i).trigger("mouseover").trigger("mouseup")}},_moveFocus:function(n,t){var u,i,r;if(isNaN(n)?i=parseInt(this._optionLis.filter(n).data("index"),10):(u=parseInt(this._focusedOptionLi().data("index")||0,10),i=u+n),i<0&&(i=0),i>this._optionLis.size()-1&&(i=this._optionLis.size()-1),i===t)return!1;r="ui-selectmenu-item-"+Math.round(Math.random()*1e3),this._focusedOptionLi().find("a:eq(0)").attr("id",""),this._optionLis.eq(i).hasClass("ui-state-disabled")?(n>0?++n:--n,this._moveFocus(n,i)):this._optionLis.eq(i).find("a:eq(0)").attr("id",r).focus(),this.list.attr("aria-activedescendant",r)},_scrollPage:function(n){var t=Math.floor(this.list.outerHeight()/this._optionLis.first().outerHeight());t=n=="up"?-t:t,this._moveFocus(t)},_setOption:function(n,t){this.options[n]=t,n=="disabled"&&(t&&this.close(),this.element.add(this.newelement).add(this.list)[t?"addClass":"removeClass"]("ui-selectmenu-disabled ui-state-disabled").attr("aria-disabled",t))},disable:function(n,t){typeof n=="undefined"?this._setOption("disabled",!0):t=="optgroup"?this._toggleOptgroup(n,!1):this._toggleOption(n,!1)},enable:function(n,t){typeof n=="undefined"?this._setOption("disabled",!1):t=="optgroup"?this._toggleOptgroup(n,!0):this._toggleOption(n,!0)},_disabled:function(t){return n(t).hasClass("ui-state-disabled")},_toggleOption:function(n,t){var i=this._optionLis.eq(n);i&&(i.toggleClass("ui-state-disabled",t).find("a").attr("aria-disabled",!t),t?this.element.find("option").eq(n).attr("disabled","disabled"):this.element.find("option").eq(n).removeAttr("disabled"))},_toggleOptgroup:function(n,t){var i=this.list.find("li.ui-selectmenu-group-"+n);i&&(i.toggleClass("ui-state-disabled",t).attr("aria-disabled",!t),t?this.element.find("optgroup").eq(n).attr("disabled","disabled"):this.element.find("optgroup").eq(n).removeAttr("disabled"))},index:function(t){if(arguments.length){if(this._disabled(n(this._optionLis[t]))||t==this._selectedIndex())return!1;this.element[0].selectedIndex=t,this._refreshValue(),this.change()}else return this._selectedIndex()},value:function(n){if(arguments.length&&n!=this.element[0].value)this.element[0].value=n,this._refreshValue(),this.change();else return this.element[0].value},_refreshValue:function(){var t=this.options.style=="popup"?" ui-state-active":"",i="ui-selectmenu-item-"+Math.round(Math.random()*1e3),r,n;this.list.find(".ui-selectmenu-item-selected").removeClass("ui-selectmenu-item-selected"+t).find("a").attr("aria-selected","false").attr("id",""),this._selectedOptionLi().addClass("ui-selectmenu-item-selected"+t).find("a").attr("aria-selected","true").attr("id",i),r=this.newelement.data("optionClasses")?this.newelement.data("optionClasses"):"",n=this._selectedOptionLi().data("optionClasses")?this._selectedOptionLi().data("optionClasses"):"",this.newelement.removeClass(r).data("optionClasses",n).addClass(n).find(".ui-selectmenu-status").html(this._selectedOptionLi().find("a:eq(0)").html()),this.list.attr("aria-activedescendant",i)},_refreshPosition:function(){var r=this.options,t={of:this.newelement,my:"left top",at:"left bottom",collision:"flip"},i;r.style=="popup"&&(i=this._selectedOptionLi(),t.my="left top"+(this.list.offset().top-i.offset().top-(this.newelement.outerHeight()+i.outerHeight())/2),t.collision="fit"),this.listWrap.removeAttr("style").zIndex(this.element.zIndex()+1).position(n.extend(t,r.positionOptions))}})})(jQuery);
//# sourceMappingURL=jquery.ui.selectmenu.min.js.map